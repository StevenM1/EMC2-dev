<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimating Marginal likelihoods using WARP-III bridge sampling — run_bridge_sampling • EMC2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Marginal likelihoods using WARP-III bridge sampling — run_bridge_sampling"><meta property="og:description" content="Uses bridge sampling that matches a proposal distribution to the first three moments
of the posterior distribution to get an accurate estimate of the marginal likelihood.
The marginal likelihood can be used for computing Bayes factors and posterior model probabilities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EMC2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimating Marginal likelihoods using WARP-III bridge sampling</h1>

    <div class="hidden name"><code>run_bridge_sampling.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses bridge sampling that matches a proposal distribution to the first three moments
of the posterior distribution to get an accurate estimate of the marginal likelihood.
The marginal likelihood can be used for computing Bayes factors and posterior model probabilities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_bridge_sampling</span><span class="op">(</span></span>
<span>  <span class="va">emc</span>,</span>
<span>  stage <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cores_for_props <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cores_per_prop <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  both_splits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-emc">emc<a class="anchor" aria-label="anchor" href="#arg-emc"></a></dt>
<dd><p>An emc object with a set of converged samples</p></dd>


<dt id="arg-stage">stage<a class="anchor" aria-label="anchor" href="#arg-stage"></a></dt>
<dd><p>A character indicating which stage to use, defaults to <code>sample</code></p></dd>


<dt id="arg-filter">filter<a class="anchor" aria-label="anchor" href="#arg-filter"></a></dt>
<dd><p>An integer or vector. If integer, it will exclude up until
that integer. If vector it will include everything in that range.</p></dd>


<dt id="arg-repetitions">repetitions<a class="anchor" aria-label="anchor" href="#arg-repetitions"></a></dt>
<dd><p>An integer. How many times to repeat the bridge sampling scheme. Can help get an estimate of stability of the estimate.</p></dd>


<dt id="arg-cores-for-props">cores_for_props<a class="anchor" aria-label="anchor" href="#arg-cores-for-props"></a></dt>
<dd><p>Integer. Warp-III evaluates the posterior over 4 different proposal densities. If you have the CPU, 4 cores will do this in parallel, 2 is also already helpful.</p></dd>


<dt id="arg-cores-per-prop">cores_per_prop<a class="anchor" aria-label="anchor" href="#arg-cores-per-prop"></a></dt>
<dd><p>Integer. Per density we can also parallelize across subjects. Eventual cores will be <code>cores_for_props</code> * <code>cores_per_prop</code>. For efficiency users should prioritize cores_for_props being 4.</p></dd>


<dt id="arg-both-splits">both_splits<a class="anchor" aria-label="anchor" href="#arg-both-splits"></a></dt>
<dd><p>Boolean. Bridge sampling uses a proposal density and a target density. We can estimate the stability of our samples and therefore MLL estimate, by running 2 bridge sampling iterations
The first one uses the first half of the samples as the proposal and the second half as the target, the second run uses the opposite. If this is is set to <code>FALSE</code>, it will only run bridge sampling once and
it will instead do an odd-even iterations split to get a more reasonable estimate for just one run.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional, optional more in-depth hyperparameters</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A vector of length repetitions which contains the marginal log likelihood estimates per repetition</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If not enough posterior samples were collected using <code><a href="fit.html">fit()</a></code>,
bridge sampling can be unstable. It is recommended to run
<code>run_bridge_sampling()</code> several times with the <code>repetitions</code> argument
and to examine how stable the results are.</p>
<p>It can be difficult to converge bridge sampling for exceptionally large models,
because of a large number of subjects (&gt; 100) and/or cognitive model parameters.</p>
<p>For a practical introduction:</p>
<p>Gronau, Q. F., Heathcote, A., &amp; Matzke, D. (2020). Computing Bayes factors
for evidence-accumulation models using Warp-III bridge sampling.
<em>Behavior research methods</em>, 52(2), 918-937. doi.org/10.3758/s13428-019-01290-6</p>
<p>For mathematical background:</p>
<p>Meng, X.-L., &amp; Wong, W. H. (1996). Simulating ratios of normalizing
constants via a simple identity: A theoretical exploration. <em>Statistica Sinica</em>,
6, 831-860. http://www3.stat.sinica.edu.tw/statistica/j6n4/j6n43/j6n43.htm</p>
<p>Meng, X.-L., &amp; Schilling, S. (2002). Warp bridge sampling.
<em>Journal of Computational and Graphical Statistics</em>,
11(3), 552-586. doi.org/10.1198/106186002457</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># After `fit` has converged on a specific model</span></span></span>
<span class="r-in"><span><span class="co"># We can take those samples and calculate the marginal log-likelihood for them</span></span></span>
<span class="r-in"><span><span class="va">MLL</span> <span class="op">&lt;-</span> <span class="fu">run_bridge_sampling</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">samples_LNR</span><span class="op">)</span>, cores_per_prop <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># This will run on 2*4 cores (since 4 is the default for ``cores_for_props``)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Niek Stevenson, Michelle Donzallaz, Andrew Heathcote.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

