<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Posterior predictive checks — plot_fit • EMC2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Posterior predictive checks — plot_fit"><meta name="description" content="Plot (defective) cumulative density functions of the observed data and data from the
posterior predictive distribution: the probability of a response,
p(R) as a function of response time for the experimental data and posterior
predictive simulations."><meta property="og:description" content="Plot (defective) cumulative density functions of the observed data and data from the
posterior predictive distribution: the probability of a response,
p(R) as a function of response time for the experimental data and posterior
predictive simulations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EMC2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Simulation-based-Calibration.html">Simulation-based Calibration</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ampl-psych/EMC2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Posterior predictive checks</h1>
      <small class="dont-index">Source: <a href="https://github.com/ampl-psych/EMC2/blob/HEAD/R/plotting.R" class="external-link"><code>R/plotting.R</code></a></small>
      <div class="d-none name"><code>plot_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot (defective) cumulative density functions of the observed data and data from the
posterior predictive distribution: the probability of a response,
p(R) as a function of response time for the experimental data and posterior
predictive simulations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_fit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">pp</span>,</span>
<span>  subject <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  functions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat_name <span class="op">=</span> <span class="st">""</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  quants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  do_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mfcol <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>  data_lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  fit_lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  q_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  qp_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pqp_cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  lpos <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame. The experimental data in EMC2 format with at least <code>subject</code> (i.e., the
subject factor), <code>R</code> (i.e., the response factor) and <code>rt</code> (i.e., response time) variable.
Additional factor variables of the design are optional.</p></dd>


<dt id="arg-pp">pp<a class="anchor" aria-label="anchor" href="#arg-pp"></a></dt>
<dd><p>A data frame. Posterior predictives created by <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code></p></dd>


<dt id="arg-subject">subject<a class="anchor" aria-label="anchor" href="#arg-subject"></a></dt>
<dd><p>Integer or string selecting a subject from the data. If specified only that subject
is plotted. <code>NULL</code> (i.e., the default), will plot all subjects.</p></dd>


<dt id="arg-factors">factors<a class="anchor" aria-label="anchor" href="#arg-factors"></a></dt>
<dd><p>Character vector of factors in data to display separately. If
NULL (default) use names of all columns in data except "trials","R", and "rt".
Omitted factors are aggregated over. If NA treats entire data set as a single cell.
Must be NA or NULL when using stat argument.</p></dd>


<dt id="arg-functions">functions<a class="anchor" aria-label="anchor" href="#arg-functions"></a></dt>
<dd><p>A named list of functions that create new factors which can then be
used by the factors and stat arguments.</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>A function that takes the data/the posterior predictives and returns a single value.
For the posterior predictives it will use a single value per replicate, which are then plotted as a density.</p></dd>


<dt id="arg-stat-name">stat_name<a class="anchor" aria-label="anchor" href="#arg-stat-name"></a></dt>
<dd><p>A string naming what the stat argument calculates, used in labeling the x-axis of the plot.</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Numeric. Density function bandwidth adjust parameter. See “?density`</p></dd>


<dt id="arg-quants">quants<a class="anchor" aria-label="anchor" href="#arg-quants"></a></dt>
<dd><p>A vector. Quantiles of the posterior predictives to return when stat argument is supplied.</p></dd>


<dt id="arg-do-plot">do_plot<a class="anchor" aria-label="anchor" href="#arg-do-plot"></a></dt>
<dd><p>Boolean. Set to <code>FALSE</code> to only return the quantiles and omit the plots.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>A numeric vector. x-axis plot limit.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>A numeric vector. y-axis plot limit.</p></dd>


<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>A vector specifying the layout as in <code>par(mfrow = layout)</code>.
If <code>NA</code> or <code>NULL</code> uses current plot window layout.</p></dd>


<dt id="arg-mfcol">mfcol<a class="anchor" aria-label="anchor" href="#arg-mfcol"></a></dt>
<dd><p>Boolean.  If <code>TRUE</code> uses par(mfrow = layout), otherwise uses par(mfcol = layout)</p></dd>


<dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>Vector of probabilities at which to calculate cumulative density function</p></dd>


<dt id="arg-data-lwd">data_lwd<a class="anchor" aria-label="anchor" href="#arg-data-lwd"></a></dt>
<dd><p>Integer. Line width for data</p></dd>


<dt id="arg-fit-lwd">fit_lwd<a class="anchor" aria-label="anchor" href="#arg-fit-lwd"></a></dt>
<dd><p>Integer. Line width for posterior predictives</p></dd>


<dt id="arg-q-points">q_points<a class="anchor" aria-label="anchor" href="#arg-q-points"></a></dt>
<dd><p>Vector. Quantile points to plot</p></dd>


<dt id="arg-qp-cex">qp_cex<a class="anchor" aria-label="anchor" href="#arg-qp-cex"></a></dt>
<dd><p>Numeric. Cex for data quantile points</p></dd>


<dt id="arg-pqp-cex">pqp_cex<a class="anchor" aria-label="anchor" href="#arg-pqp-cex"></a></dt>
<dd><p>Numeric. Cex for predicted quantile points</p></dd>


<dt id="arg-lpos">lpos<a class="anchor" aria-label="anchor" href="#arg-lpos"></a></dt>
<dd><p>Character. Legend position, see <code>?legend()</code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Character. Pasted before the plot title, especially useful when specifying a stat argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If stat argument is provided, a vector of observed values and predicted quantiles
is returned</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The data is plotted in black. Large grey points show the average quantiles across the posterior predictives.
The small grey points represent the predicted quantile of an individual replicate,
providing a representation of uncertainty in the model predictions.</p>
<p>If the stat argument is supplied (which calculates a statistic based on the data),
the posterior predictives are plotted as a density over the different replicates.
A vertical line is plotted at the value of that statistic for the experimental data.</p>
<p>If more than one subject is included, the data and fits are aggregated across subjects by default.</p>
<p>Also see <code>?plot_defective_density()</code> for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># First generate posterior predictives based on an emc object run with run_emc</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">samples_LNR</span>, n_cores <span class="op">=</span> <span class="fl">1</span>, n_post <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then visualize the model fit</span></span></span>
<span class="r-in"><span><span class="fu">plot_fit</span><span class="op">(</span><span class="va">forstmann</span>, <span class="va">pp</span>, factors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"E"</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_fit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specific statistics on the posterior predictives can also be specified</span></span></span>
<span class="r-in"><span><span class="co"># This function calculates the difference in rt between two S levels.</span></span></span>
<span class="r-in"><span><span class="co"># It takes the data (or the posterior predictives) as an argument</span></span></span>
<span class="r-in"><span><span class="va">drt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">rt</span>,<span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span><span class="op">)</span><span class="op">]</span>,<span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_fit</span><span class="op">(</span><span class="va">forstmann</span>, <span class="va">pp</span>, stat<span class="op">=</span><span class="va">drt</span>,stat_name<span class="op">=</span><span class="st">"Rt difference"</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="op">(</span><span class="st">"Left vs Right"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-plt img"><img src="plot_fit-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niek Stevenson, Michelle Donzallaz, Andrew Heathcote.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

