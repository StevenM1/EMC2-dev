<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Posterior predictive checks — plot_fit • EMC2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Posterior predictive checks — plot_fit"><meta property="og:description" content="Plot (defective) cumulative density functions of the observed data and data from the
posterior predictive distribution: the probability of a response,
p(R) as a function of response time for the experimental data and posterior
predictive simulations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EMC2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Posterior predictive checks</h1>

    <div class="hidden name"><code>plot_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot (defective) cumulative density functions of the observed data and data from the
posterior predictive distribution: the probability of a response,
p(R) as a function of response time for the experimental data and posterior
predictive simulations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_fit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">pp</span>,</span>
<span>  subject <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  functions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat_name <span class="op">=</span> <span class="st">""</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  quants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  do_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mfcol <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>  data_lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  fit_lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  q_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  qp_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pqp_cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  lpos <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame. The experimental data in EMC2 format with at least <code>subject</code> (i.e., the
subject factor), <code>R</code> (i.e., the response factor) and <code>rt</code> (i.e., response time) variable.
Additional factor variables of the design are optional.</p></dd>


<dt id="arg-pp">pp<a class="anchor" aria-label="anchor" href="#arg-pp"></a></dt>
<dd><p>A data frame. Posterior predictives created by <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code></p></dd>


<dt id="arg-subject">subject<a class="anchor" aria-label="anchor" href="#arg-subject"></a></dt>
<dd><p>Integer or string selecting a subject from the data. If specified only that subject
is plotted. <code>NULL</code> (i.e., the default), will plot all subjects.</p></dd>


<dt id="arg-factors">factors<a class="anchor" aria-label="anchor" href="#arg-factors"></a></dt>
<dd><p>Character vector of factors in data to display separately. If
NULL (default) use names of all columns in data except "trials","R", and "rt".
Omitted factors are aggregated over. If NA treats entire data set as a single cell.
Must be NA or NULL when using stat argument.</p></dd>


<dt id="arg-functions">functions<a class="anchor" aria-label="anchor" href="#arg-functions"></a></dt>
<dd><p>A named list of functions that create new factors which can then be
used by the factors and stat arguments.</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>A function that takes the data/the posterior predictives and returns a single value.
For the posterior predictives it will use a single value per replicate, which are then plotted as a density.</p></dd>


<dt id="arg-stat-name">stat_name<a class="anchor" aria-label="anchor" href="#arg-stat-name"></a></dt>
<dd><p>A string naming what the stat argument calculates, used in labeling the x-axis of the plot.</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Numeric. Density function bandwidth adjust parameter. See “?density`</p></dd>


<dt id="arg-quants">quants<a class="anchor" aria-label="anchor" href="#arg-quants"></a></dt>
<dd><p>A vector. Quantiles of the posterior predictives to return when stat argument is supplied.</p></dd>


<dt id="arg-do-plot">do_plot<a class="anchor" aria-label="anchor" href="#arg-do-plot"></a></dt>
<dd><p>Boolean. Set to <code>FALSE</code> to only return the quantiles and omit the plots.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>A numeric vector. x-axis plot limit.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>A numeric vector. y-axis plot limit.</p></dd>


<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>A vector specifying the layout as in <code>par(mfrow = layout)</code>.
If <code>NA</code> or <code>NULL</code> uses current plot window layout.</p></dd>


<dt id="arg-mfcol">mfcol<a class="anchor" aria-label="anchor" href="#arg-mfcol"></a></dt>
<dd><p>Boolean.  If <code>TRUE</code> uses par(mfrow = layout), otherwise uses par(mfcol = layout)</p></dd>


<dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>Vector of probabilities at which to calculate cumulative density function</p></dd>


<dt id="arg-data-lwd">data_lwd<a class="anchor" aria-label="anchor" href="#arg-data-lwd"></a></dt>
<dd><p>Integer. Line width for data</p></dd>


<dt id="arg-fit-lwd">fit_lwd<a class="anchor" aria-label="anchor" href="#arg-fit-lwd"></a></dt>
<dd><p>Integer. Line width for posterior predictives</p></dd>


<dt id="arg-q-points">q_points<a class="anchor" aria-label="anchor" href="#arg-q-points"></a></dt>
<dd><p>Vector. Quantile points to plot</p></dd>


<dt id="arg-qp-cex">qp_cex<a class="anchor" aria-label="anchor" href="#arg-qp-cex"></a></dt>
<dd><p>Numeric. Cex for data quantile points</p></dd>


<dt id="arg-pqp-cex">pqp_cex<a class="anchor" aria-label="anchor" href="#arg-pqp-cex"></a></dt>
<dd><p>Numeric. Cex for predicted quantile points</p></dd>


<dt id="arg-lpos">lpos<a class="anchor" aria-label="anchor" href="#arg-lpos"></a></dt>
<dd><p>Character. Legend position, see <code>?legend()</code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Character. Pasted before the plot title, especially useful when specifying a stat argument.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If stat argument is provided, a vector of observed values and predicted quantiles
is returned</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The data is plotted in black. Large grey points show the average quantiles across the posterior predictives.
The small grey points represent the predicted quantile of an individual replicate,
providing a representation of uncertainty in the model predictions.</p>
<p>If the stat argument is supplied (which calculates a statistic based on the data),
the posterior predictives are plotted as a density over the different replicates.
A vertical line is plotted at the value of that statistic for the experimental data.</p>
<p>If more than one subject is included, the data and fits are aggregated across subjects by default.</p>
<p>Also see <code>?plot_defective_density()</code> for more details.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># First generate posterior predictives based on an emc object run with run_emc</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">samples_LNR</span>, n_cores <span class="op">=</span> <span class="fl">1</span>, n_post <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then visualize the model fit</span></span></span>
<span class="r-in"><span><span class="fu">plot_fit</span><span class="op">(</span><span class="va">forstmann</span>, <span class="va">pp</span>, factors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"E"</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_fit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specific statistics on the posterior predictives can also be specified</span></span></span>
<span class="r-in"><span><span class="co"># This function calculates the difference in rt between two S levels.</span></span></span>
<span class="r-in"><span><span class="co"># It takes the data (or the posterior predictives) as an argument</span></span></span>
<span class="r-in"><span><span class="va">drt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">rt</span>,<span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span><span class="op">)</span><span class="op">]</span>,<span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_fit</span><span class="op">(</span><span class="va">forstmann</span>, <span class="va">pp</span>, stat<span class="op">=</span><span class="va">drt</span>,stat_name<span class="op">=</span><span class="st">"Rt difference"</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="op">(</span><span class="st">"Left vs Right"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-plt img"><img src="plot_fit-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Niek Stevenson, Michelle Donzallaz, Andrew Heathcote.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

